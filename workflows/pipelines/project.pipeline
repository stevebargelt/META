name: project
description: End-to-end new project kickoff and build orchestration
timeout_min: 90

# NUM | AGENT | CLI | GATE | PARALLEL_GROUP | TIMEOUT_MIN | PROMPT
1 | base            | -           | auto | - | 5  | Preflight check: Run META/scripts/preflight-gate.sh --project . (or parent if not yet bootstrapped). Report any failures in .meta/handoff.md. If blockers exist, stop and explain what needs to be fixed.
2 | base            | interactive | auto | - | 45 | Run kickoff using ../META/prompts/kickoff.md (adjust path if needed). Ask questions in the tmux step window, write AGENTS.md, ensure CLAUDE.md is a symlink, and summarize answers in .meta/handoff.md. Exit the session when done.
3 | product-manager | - | auto | - | 45 | Create docs/PRD.md from kickoff answers in .meta/handoff.md. Update .meta/handoff.md with scope and open questions.
4 | architect       | - | gate | - | 45 | Design architecture from PRD. Create docs/ARCHITECTURE.md and update .meta/handoff.md with decisions.
5 | base            | interactive | auto | - | 30 | External services setup + info discovery. Read .meta/handoff.md and ARCHITECTURE.md to identify required external services (e.g., Supabase, Auth0, S3). Ask for setup details, create/update .env.example and a setup note in docs/SETUP.md. Use META/prompts/external-service-setup-checklist.md. If none needed, note "no external services" in .meta/handoff.md. Exit when complete.
6 | orchestrator    | - | gate | - | 45 | Create a build plan and write it to .meta/next.pipeline. CRITICAL: You MUST implement ALL features and platforms specified in the PRD. Do NOT silently drop requirements. If the PRD says "web + mobile", the pipeline MUST include BOTH. If you believe scope should be reduced, you MUST stop and ask for explicit approval - do not proceed with a reduced scope without consent. CRITICAL FORMAT: Each step line MUST have exactly 7 pipe-separated fields: NUM \| AGENT \| CLI \| GATE \| PARALLEL_GROUP \| TIMEOUT_MIN \| PROMPT. Example: `1 \| base \| - \| auto \| - \| 15 \| Your prompt here`. CLI is usually `-` (non-interactive) or `interactive`. GATE is `auto` or `gate`. Include name/description/timeout_min header and sequential step numbers starting at 1. Use only these agent names: base, product-manager, architect, tester, reviewer, debugger, documenter, devops-engineer, orchestrator. If you plan any PARALLEL_GROUPs: (1) add a contract stub step before parallel work (use META/prompts/contract-stub.md), (2) add a build validation step after each parallel group completes (`npm run build && npm test` at workspace root to catch integration issues early). Identify independent workstreams and assign PARALLEL_GROUP labels. If no parallelism is safe, explain why in .meta/handoff.md. REQUIRED: Include a devops-engineer step after implementation to set up CI/CD pipelines, deployment workflows (Vercel/Supabase), and observability (Sentry/PostHog). REQUIRED: For projects with a database backend, include a DATA LAYER SETUP step BEFORE frontend implementation that: (1) generates database types (supabase gen types), (2) sets up data fetching provider (QueryClientProvider), (3) creates typed API client, (4) creates auth hooks, (5) creates entity data hooks (useTasks, useEvents, etc.). Frontend implementation steps MUST use these hooks with REAL data - NO mock data allowed except in tests. Include a Definition-of-Done checklist step (use META/prompts/definition-of-done-checklist.md) with a gate near the end. Include a final quality gate step that runs META/scripts/quality-gate.sh. At the END of .meta/handoff.md, add a "Scope Verification" section listing each platform/feature from the PRD and which pipeline step implements it. Update .meta/handoff.md with the plan summary.
7 | base            | -           | gate | - | 5  | Scope verification gate: Run META/scripts/scope-verification.sh --project . to compare PRD requirements against the generated pipeline. If the script exits non-zero (gaps found), STOP and present the gaps to the user. Either add missing steps to .meta/next.pipeline or create docs/DEFERRED.md with explicit justifications for each deferred item. Do NOT proceed until scope-verification.sh passes or user explicitly approves deferrals.
